<html xmlns="http://www.w3.org/1999/xhtml">
<head>

    <meta http-equiv="X-UA-Compatible" content="IE=7" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>首页</title>
    <style type="text/css" media="all">
        @import url("${request.contextPath}/static/css/style.css");
        @import url("${request.contextPath}/static/css/jquery.wysiwyg.css");
        @import url("${request.contextPath}/static/css/facebox.css");
        @import url("${request.contextPath}/static/css/visualize.css");
        @import url("${request.contextPath}/static/css/date_input.css");
    </style>
    <!--[if lt IE 8]><style type="text/css" media="all">@import url("${request.contextPath}/static/css/ie.css");</style><![endif]-->
</head>
<p>

<div id="hld">

    <form class="wrapper">		<!-- wrapper begins -->
        <div id="header">
            <div class="hdrl"></div>
            <div class="hdrr"></div>

            <h1><a href="#">CIMS</a></h1>

            <ul id="nav">
                <#if homeActive??>
                <li class="active"><a href="${request.contextPath}/index">主页</a></li>
                <#else>
                <li><a href="${request.contextPath}/index">主页</a></li>
                </#if>
                <#if menuString??>
                    ${menuString}
                </#if>
            </ul>

            <p class="user">欢迎,
                <#if user??>
                <a href="#">${user.username}</a>
                <#else>
                <a href="${request.contextPath}/login">陌生人</a>
                </#if>
                <#if roles??>
                | <select name="roles" style="background-color: #202020;color: #999; border: none" onchange="changeRole(this.value)">
                        <#list roles as role>
                        <#if activeRole.roleName==role.roleName>
                        <option selected value="${role.roleId}">${role.roleName}</option>
                        <#else>
                        <option value="${role.roleId}">${role.roleName}</option>
                        </#if>
                    </#list>
                    </select>
                </#if>
                | <a href="${request.contextPath}/logout">退出</a>
            </p>
        </div>		<!-- #header ends -->
        <script type="text/javascript" language="javascript">
            // function getClientHeight()
            // {
            //     var clientHeight=0;
            //     if(document.body.clientHeight&&document.documentElement.clientHeight)
            //     {
            //         var clientHeight = (document.body.clientHeight<document.documentElement.clientHeight)?document.body.clientHeight:document.documentElement.clientHeight;
            //     }
            //     else
            //     {
            //         var clientHeight = (document.body.clientHeight>document.documentElement.clientHeight)?document.body.clientHeight:document.documentElement.clientHeight;
            //     }
            //     return clientHeight;
            // }
            function iFramePre() {
                //判断路径

                var ifm= document.getElementById("mainFrame");
                //if(ifm.indexOf("/login"))
                var srcString=ifm.contentWindow.location.href;
                if(srcString.indexOf("/login")+6==srcString.length){
                    window.location.href=srcString;
                }
                var scrollHeigth=mainFrame.document.body.scrollHeight;
                //165
                var showHeigth=document.body.clientHeight-165;
                console.log(scrollHeigth);
                if(scrollHeigth<=showHeigth){
                    ifm.height=showHeigth;
                }
                else {
                    ifm.height=scrollHeigth;
                }

                // var subWeb = document.frames ? document.frames["mainFrame"].document : ifm.contentDocument;
                // if(ifm != null && subWeb != null) {
                //     var h=getClientHeight();
                //     if(subWeb.body.scrollHeight<h){
                //         ifm.height=h*0.8;
                //     }
                //     else {
                //         ifm.height = subWeb.body.scrollHeight;
                //     }
            }
        </script>
        <iframe name="mainFrame" id="mainFrame" frameBorder=0 scrolling=no width="100%" onload="iFramePre()" src="${request.contextPath}/index/welcome" scrolling="yes"></iframe>

        <div id="footer">

            <p class="left"><a href="tel:13541210431">联系管理员</a></p>
            <p class="right">powered by 肖承祥</a></p>

        </div>
</div>		<!-- #hld ends -->
<script>
    function changeRole(role){
        window.location.href="${request.contextPath}/index?role="+role;
    }
</script>
<!--[if IE]><script type="text/javascript" src="${request.contextPath}/static/js/excanvas.js"></script><![endif]-->
<script type="text/javascript" src="${request.contextPath}/static/js/jquery.js"></script>
<script type="text/javascript" src="${request.contextPath}/static/js/jquery.img.preload.js"></script>
<script type="text/javascript" src="${request.contextPath}/static/js/jquery.filestyle.mini.js"></script>
<script type="text/javascript" src="${request.contextPath}/static/js/jquery.wysiwyg.js"></script>
<script type="text/javascript" src="${request.contextPath}/static/js/jquery.date_input.pack.js"></script>
<script type="text/javascript" src="${request.contextPath}/static/js/facebox.js"></script>
<script type="text/javascript" src="${request.contextPath}/static/js/jquery.visualize.js"></script>
<script type="text/javascript" src="${request.contextPath}/static/js/jquery.visualize.tooltip.js"></script>
<script type="text/javascript" src="${request.contextPath}/static/js/jquery.select_skin.js"></script>
<script type="text/javascript" src="${request.contextPath}/static/js/jquery.tablesorter.min.js"></script>
<script type="text/javascript" src="${request.contextPath}/static/js/ajaxupload.js"></script>
<script type="text/javascript" src="${request.contextPath}/static/js/jquery.pngfix.js"></script>
<script type="text/javascript" src="${request.contextPath}/static/js/custom.js"></script>
</body>
</html>
